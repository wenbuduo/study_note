本文介绍了Casanovo，这是一种从头进行肽测序的新方法，它利用变压器模型将质谱直接映射到氨基酸序列。与以前依赖复杂模型和多个神经网络的方法相比，这种方法简化了流程。
## Q：问题背景
串联质谱法：质量相近频谱相似，评分优先
## Q：文章所做的贡献
最后，我们训练了 Casanovo 的三个附加变体，与标准模型相比，它们都没有提供任何性能改进（表 3）。第一个变体使用焦点损失函数（Qiao et al., 2021），而不是交叉熵。我们还研究了两种替代的峰嵌入方法。第一种方法也来自 PointNovo，用 I 值和 m/z 嵌入的直接相乘来代替 m/z 和 I 嵌入的求和。第二个峰值嵌入策略对 I 实现正弦编码，类似于 m/z 嵌入，但仅使用 32 维，并将 I 与 m/z 嵌入连接起来，而不是将两者相加
## Q：实现步骤

![[Pasted image 20241126162226.png]]
首先对峰值，前体，位置进行编码，形成一个嵌入向量表
其次，将前面描述的嵌入作为输入，转换器输出分数，这些分数被视为每个解码步骤中序列中下一个位置的氨基酸词汇上的概率分布。氨基酸词汇包括 20 种规范氨基酸、其中 3 种的翻译后修饰版本（甲硫氨酸的氧化和天冬酰胺或谷氨酰胺的脱酰胺），加上一个特殊的停止标记来表示解码结束，总共产生 24 个标记。在训练过程中，解码器按照教师强制范式（Williams & Zipser，1989）被输入真实肽的氨基酸前缀。模型输出概率和表示真实肽的氨基酸序列的二元矩阵之间的交叉熵被最小化作为目标函数。在推理过程中，预测序列中每个位置的得分最高的氨基酸，并在每个解码步骤向解码器提供其先前的氨基酸预测。当预测到停止标记或达到预定义的最大肽长度` = 100 个氨基酸时，解码完成。
前体 m/z 过滤：我们根据数据库搜索中使用的前体质量误差容限进行选择，以获得测试数据的真实肽序列

## Q:启发是什么
- 先前的从头肽测序工作使用了深度学习模型，该模型结合了单独的神经网络架构和复杂的后处理步骤。 Casanovo 利用变压器架构来生成统一的解决方案来转换质谱直接转化为肽序列，无需对谱图 m/z 轴进行离散化，也无需进行复杂的后处理。Casanovo 的推理速度足够快，可以实现实时从头测序，即以质谱仪生成光谱的速度进​​行测序，从而提高了帮助指导正在进行的质谱实验的可能性。在实践中，实时搜索结果可用于决定肽洗脱顺序、提高稳定同位素标记的准确性 、翻译后修饰位点定位 ，或决定是否触发 MS3扫描。 Casanovo 在肽级精度方面比以前的技术水平有了显着提高，但这使得测试光谱的很大一部分没有可信的预测。显然，探索对这些光谱进行良好预测的方法是未来研究的一个途径。
- 通过在 m/z 滤波器消除 Casanovo 预测时插入 DeepNovo 预测来组合 Casanovo 和 DeepNovo 预测。由此产生的模型的肽精度比 Casanovo 高出 10%，并且在跨物种的所有评估指标上都超过了之前最先进的方法 PointNovo。这一观察结果表明，前体信息应作为质谱建模中更强大的先验信息。一种简单的方法可能涉及在推理过程中从波束搜索生成的更大的一组候选肽中进行选择，并对预测质量进行限制。或者，可以修改 Casanovo 的损失函数以惩罚与前体质量不匹配的肽预测。

