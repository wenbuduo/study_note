## 基础名词了解
- Tandem mass spectrometry(MS）串联质谱预测
- 在肽段序列预测和质谱分析中，DDA（Data-Dependent Acquisition）和DIA（Data-Independent Acquisition）是两种常用的质谱数据获取策略。它们在实验设计和数据分析方式上有显著的不同，各自适用于不同的研究需求。
- 新合成多肽链中用于指导蛋白质的跨膜转移的N-末端的氨基酸序列
- 肽段序列是指新合成多肽链中用于指导蛋白质的跨膜转移的N-末端的氨基酸序列。肽序列测定是确定肽段精确组成的过程，通常使用质谱技术进行分析。了解肽段的准确序列对于深入了解其生物活性和功能至关重要。通过肽序列测定，我们可以确定肽段的氨基酸序列，进而研究其结构、相互作用以及可能的生物活性

### 1. **DDA（Data-Dependent Acquisition）**

- **定义**：DDA是一种动态选择质谱分析的策略。在这种方法中，质谱仪根据前体离子的丰度和特征动态选择要进行进一步分析的离子。
    
- **工作原理**：
    
    - 在DDA过程中，首先进行全扫描（Full Scan），获取样品中所有离子的质荷比（m/z）信息。
    - 根据预设的阈值，选择丰度最高的前体离子进行二次碎裂（MS/MS），以获取其碎片离子信息。
    - 这个过程会重复进行，每个循环中选择不同的前体离子，直到达到设定的时间限制或数据采集要求。
- **优缺点**：
    
    - **优点**：能够获得高质量的MS/MS数据，适合于靶向分析和已知肽段的识别。适用于复杂样品的分析，因为能够捕获丰度较高的肽段信息。
    - **缺点**：由于只分析丰度最高的离子，可能会遗漏低丰度肽段的信息，导致对样品的全面分析能力下降。

### 2. **DIA（Data-Independent Acquisition）**

- **定义**：DIA是一种在数据采集过程中不依赖于特定前体离子的选择，而是对整个质量范围内的前体离子同时进行碎裂和分析的方法。
    
- **工作原理**：
    
    - 在DIA过程中，质谱仪会进行全范围的扫描，收集所有离子的质谱数据，而不是动态选择特定的前体离子。
    - 通过将质谱范围划分成多个窗口，在这些窗口中进行碎裂并收集MS/MS数据。每个窗口同时收集所有离子的碎片信息。
    - 数据分析时，使用算法对这些数据进行解析，识别和定量不同的肽段。
- **优缺点**：
    
    - **优点**：DIA能够捕获样品中所有可检测的肽段，因此在低丰度肽段的识别和定量上表现更好。适合于全谱系分析和目标未知的样品分析。
    - **缺点**：数据量庞大，数据分析复杂度高，需要更强大的计算能力和更精细的算法来进行后续的数据解读。

### 总结

DDA和DIA各有其优势和局限，选择哪种策略通常取决于研究目标和样品特性。在靶向分析已知肽段时，DDA可能更为合适，而在需要全面分析样品组分，尤其是在低丰度探测和复杂样品中，DIA则提供了更为全面的解决方案。
## 模型综述

### Deep Novo-DIA
Deep Novo-DIA [ 2 ]将Deep Novo模型推广到使用数据独立采集( DIA )产生的数据。该模型的核心与Deep Novo类似，包括ion - CNN、spectrum - CNN和LSTM组件。主要区别在于，由于DIA数据可以沿着时间轴组织，具有包含给定分析物信息的多次相邻扫描，因此DeepNovo - DIA的预处理步骤涉及检测3D碎片离子特征和2D前体离子特征
### SMSNet [ 3 ]
采用了与DeepNovo类似的模型架构，但将其应用于从头搜索环境的变体中，其中肽数据库用于填充模糊的预测。深度神经网络由一个编码器组成，类似于Deep Novo中的ion - CNN网络，该网络以长度为1024的特征向量编码输入光谱向量的概貌。该向量用于初始化解码器，解码器使用RNN架构，在给定预测前缀的情况下，迭代预测每个氨基酸。与Deep Novo一样，背包算法用于确保预测的肽质量与观察到的前体质量在指定的公差范围内匹配。在推理过程中，SMSNet采用波束搜索解码，波束大小为20。SMSNet使用这些校准后的分数来掩盖低置信度的预测，从而在牺牲部分覆盖率的情况下提高模型的准确性。为了减少覆盖率的损失，SMSNet识别"序列标签" - -高置信度氨基酸预测的连续块- -用于匹配肽数据库。
### RANovo [4] 
采用了具有深度残差网络架构的CNN [ 59 ]。因此，除了从层到层直接传递信息外，RANovo还包含了从网络浅层向更深层传递信息的残差连接。该模型还融入了挤压-激励机制[ 60 ]，旨在自动识别输入特征之间的重要成对关系。该模型由2个卷积层和2个全连接层组成。
### Pep Net [ 5 ]
是一种直接输出预测肽段序列的全卷积神经网络。输入光谱表示为20 480 × 4的输入矩阵，其中第1维是离散化的m / z轴，bin大小为0.1 m / z，第2维表示峰强度和对应的m / z值，这些维度按正反顺序重复。该模型的核心是一系列五个时间卷积块[ 61 ]，每个时间卷积块以不同的分辨率进行操作。因此，整体模型旨在捕获局部和全局结构，然后将它们集成在一个最终的合并分支中。模型的输出通过一个最终的softmax层产生，得到一个大小为32 × 23的概率矩阵，其中32是最大的肽链长度
### Casanovo [7] 
使用变压器架构将从头测序视为序列到序列的翻译任务，从 MS2 谱中的一系列峰翻译为一系列氨基酸。该模型包括编码器和解码器，两者都是变压器。编码器学习输入 MS2 谱的上下文表示，而解码器在给定谱表示和先前预测的氨基酸的情况下预测肽序列中的下一个氨基酸。编码器和解码器各由九层组成，每层有 8 个头，隐藏维度为 512，前馈维度为 1024。与其他深度学习模型一样，Casanovo 使用波束搜索解码一次预测一个氨基酸的肽序列找到得分最高的预测肽序列[65]。不包括后处理步骤来强制预测的肽质量与观察到的前体质量相匹配，但可选的过滤器可以通过给它们分配负分数来惩罚超出前体质量容差的预测。
### ContraNovo 
首先，ContraNovo 向解码器提供额外的输入，包括先前预测的氨基酸的质量、剩余未推断肽的总质量以及单个氨基酸的质量。其次，除了Casanovo使用的交叉熵损失之外，ContraNovo还在损失函数中引入了对比损失项，旨在增强编码光谱和编码肽之间的相似性。
### π-HelixNovo [12] 
也采用了与 Casanovo 类似的变压器架构。然而，π-HelixNovo 引入了“互补光谱”的概念，其中，在去噪步骤之后，观察到的光谱中的每个峰都会相对于观察到的前体 m/z 值进行反映。因此，观察到的光谱中的 b 离子转化为互补光谱中相应的 y 离子。原则上，当某些b/y对不完整时，这种互补谱可以重建一些b-和y-离子。该互补光谱与观察到的光谱一起输入到编码器。此外，π-HelixNovo 提供前体 m/z 值作为编码器的输入，而不是像 Casanovo 那样仅在解码步骤中提供。
### NovoB [13] 
使用变压器并引入了相对于 Casanovo 的三个变化。首先，编码器需要几个额外的输入，包括前体质量、电荷、m/z 和强度。其次，解码器接收额外的输入，它是残余质量的显式表示。第三，该模型采用两个解码器，从N端到C端以及从C端到N端进行操作，并选择得分较高的预测，类似于BiATNovo中的独立双向解码器。
1.将质谱、序列及转录组数据加入到深度学习模型中进行一同训练，寻找三者之间潜在的相互联系，提高序列预测的准确度；
2.希望通过引入转录组的概念，提出一种全新的从头测序策略，提高序列预测的准确率；
3.虽然一些物种的多肽成分已被成功鉴定，但其余多肽成分尚未全部解析，因此利用已被鉴定的数据对模型进行微调，提高对特定物种（如蛇毒）的序列预测准确率，从而进一步开发其余的多肽成分。

### Cascadia 
Cascadia 扩展了 Casanovo 架构以处理 DIA 数据。与 DeepNovo-DIA 和 Transformer-DIA 不同，Cascadia 不依赖于初始前体检测步骤。相反，该模型采用“增强光谱”作为输入，其中包括一系列时间相邻的 MS2 扫描以及相应隔离窗口内的所有 MS1 峰值。这种方法使模型能够从有关前体同位素分布的 MS1 数据，不排除 MS1 信号较弱但 MS2 中有清晰碎片模式的肽。 Cascadia 通过 m/z 嵌入对每个输入峰进行二维保留时间编码。此外，每个峰值都与学习的嵌入相加，表明它是来自 MS1 还是 MS2 扫描。然后，该峰值表示序列由类似于 Casanovo 的标准 Transformer 编码器-解码器架构进行处理。
## PointNovo
PointNovo [17] 受到 DeepNovo 的启发，并由许多相同的作者制作。 PointNovo 的主要创新涉及消除对谱 m/z 轴进行离散化的需要，从而使模型能够利用高质量精度数据，而无需占用大量内存。 DeepNovo 使用长度为 150,000 的输入向量来表示光谱，而 PointNovo 将每个光谱表示为一组（m/z，强度）对。该模型采用了一种新颖的架构，旨在使用 PointNet 架构 [67] 的思想，以与顺序无关的方式处理一组此类元组。与 DeepNovo 不同，PointNovo 的 LSTM 组件是可选的，但经验结果表明，包含 LSTM 往往会提供更高质量的预测。
## 模型总结
![[Pasted image 20241118171720.png]]
![[Pasted image 20241118171735.png]]
## 遇到问题
- 不正确的肽标签可能会导致 de novo 工具的性能出现偏差。
- 精准的候选序列打分系统； 
- 具有相似m/z值的肽段重叠峰；
- 碎片离子的缺失（仪器等其他原因导致）；
- 噪声（来自于前体离子序列的二次碎裂或中性丢失和来自于不相关的分子）；
- 同质异序肽段和同分异构肽段的区分；
- 修饰氨基酸的识别（可能形成不寻常的碎片离子）。